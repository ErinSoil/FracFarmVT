#exploring data of fractionation study

#setwd("/Users/f003833/Documents/GitHub/FracFarmVT") #caitlin
setwd("C:/Users/F004SPC/Documents/GitHub/FracFarmVT") #erin

#load your libraries
library(tidyverse)
library(ggplot2)
library(dplyr)

##call in the analytical data
Frac <- read.csv(file="Frac.csv", header=TRUE, sep=",")
Loc <- read.csv(file="Location.csv", header=TRUE, sep=",")
Mang <- read.csv(file="Mang.csv", header=TRUE, sep=",") 
Master <- read.csv(file="Master.csv", header=TRUE, sep=",") 

# Get summary statistics
data_summary <- summary(Mang)

data_min <- min(Mang$Acres,na.rm=TRUE)
data_max <- max(Mang$Acres,na.rm=TRUE)

# replace column name (new name=old name)
Mang<-Mang %>%
  rename(Field_Code=Field.Code)

# join tables
data<-Frac %>%
  left_join(.,Mang,by="Field_Code")%>%
  mutate(Type.x=as.factor(Type.x),
         Owned=as.factor(Owned))

data<-data %>%
    left_join(.,Master,by="Field_Code") 

names(data)

#data exploration graphs

ggplot(data,aes(x=mgCpergSoilM, y=ph.x, color=Type.x)) + 
  geom_point () +
  geom_smooth(method="lm")

ggplot(data,aes(x=mgCpergSoilM, y=ph.x)) + geom_point ()

ggplot(data,aes(x=propM, y=ph.x, color=Type.x)) + 
  geom_point () +
  geom_smooth(method="lm")

ggplot(data,aes(x=ph.x, y=propM, color=Type.x)) + 
  geom_point () +
  geom_smooth(method="lm")

ggplot(data,aes(x=Type.x, y=ph.x, color=Type.x)) + 
  geom_point () +
 
  #add mean ph for each Type
 

str(data)





# count to look at summarized data
data %>%
  group_by(Type.x,Owned)%>%
  summarize(n=n())

data %>%
 count(Type.x,Owned)

data %>%
  count(Type.x,years.since.till)

data %>%
  count(Type.x,animal)

data %>%
  count(Type.x,animal)

data %>%
  count(Type.x,till.passes)

data %>%
  count(Type.x,till.depth)

data %>%
  count(Type.x,plastic.mulch)
data %>%
  count(Type.x,herbicides)
data %>%
  count(Type.x,insecticides)
data %>%
  count(Type.x,treated.seed)
data %>%
  count(Type.x,organic)
data %>%
  count(Type.x,Pattern.Drainage.Tile)
data %>%
  count(Type.x,irrigation)

data %>%
  count(Type.y,irrigation)

#summarize the data in a new dataframe

data.stats <- data %>% 
  group_by(Type.x) %>%
  summarize (n=n(),
            mean=mean(years.since.till, na.rm = TRUE), 
            min=min(years.since.till, na.rm = TRUE), 
            max=max(years.since.till, na.rm = TRUE), 
            sd=sd(years.since.till, na.rm = TRUE),
            mean=mean(years.since.till, na.rm = TRUE), 
  min=min(years.since.till, na.rm = TRUE), 
  max=max(years.since.till, na.rm = TRUE), 
  sd=sd(years.since.till, na.rm = TRUE))


#data exploration graphs

ggplot(data,aes(x=count till.passes, y=till.passes, color=Type.x)) + geom_point ()

ggplot(data,aes(x=Type.x, y=till.passes, color=Type.x)) + geom_bar ()

ggplot(data,aes(x=Type.x, y=till.depth, color=Type.x)) + geom_point ()




